{% extends 'base.html' %}

{% comment %} {% endif %} {% endcomment %}

{% load static %}

{% block title %} Maintenance {% endblock title %}

{% block modal %}
{% comment %} START costs
======================================================================================== {% endcomment %}
<div aria-hidden="true" data-backdrop="static" class="onboarding-modal modal fade animated" id="next_modal"
    role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered" role="document">
        <div class="modal-content">
            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                    class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>

            <div class="onboarding-content with-gradient">
                <h4 class="onboarding-title lead display-7 text-center"><span
                        class="onboarding-title display-4 fancy_text5 lead">Good job!</span></h4>
                {% comment %} <h4 class="onboarding-title text-muted lead display-7 text-center"><span
                        class="onboarding-title text-muted display-8 font-w600 fancy_text3 text-primary">Your records have been added.</span>
                    <span><br></span></h4> {% endcomment %}
                <div class="row pt-4">
                    <div class="col-12">
                        <div class="form-group"><label class='' for="">What do you want to do next?</label>
                            <select class="form-control" id="next_value">
                                <option value="cost"><span class="next_type">Add</span> cost</option>
                                <option value='service'><span class="next_type">Add</span> service</option>
                                <option value='attachment'><span class="next_type">Add</span> photos and videos</option>
                                <option value='nothing'>Nothing </option>
                            </select>
                        </div>
                    </div>
                </div>

                <input type="hidden" id="next_id" class='next_id'>
                <div class='form-buttons-w3 d-flex flex-row justify-content-end'> <a class="btn btn-primary px-5 py-3 "
                        id="next_submit"><span class="answer text-white">Continue
                        </span></a></div>

                <!-- <div class="form-buttons-w center text-center d-flex justify-content-end">
					<a data-dismiss="modal" class="btn btn-primary text-white px-5 py-3" id='success_button'><span>Floors in lanagata paradise</span></a>
				</div> -->
            </div>
        </div>
    </div>
</div>
<div aria-hidden="true" data-backdrop="static" style='z-index:2000' data-tab="sub_modal"
    class="onboarding-modal modal fade animated" id="add_cost_modal" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered" role="document">
        <form method="POST" id='add_cost_form'>
            <div class="modal-content">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                        class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
                <div class="onboarding-slider-w cost_sub sub_modal">
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-left fancy_text5 cost_title">Maintenance costs
                            </h4>
                            <hr>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label class="control-label">What type of cost is this?</label>
                                        <select class="form-control " name="cost_type" id="mc_material_type">
                                            <option selected value="material" class="display-7sm">Material cost</option>
                                            <option value="labour" class="display-7sm">Labour cost</option>
                                        </select> </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-12">
                                    <div class="form-group"> <label id='material_label_name' for="">Material
                                            name</label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: New sink" type="text"
                                                name="cost_name" id="mc_material">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row d-none quantity_column">
                                <div class="col-sm-12 col-12">
                                    <div class="form-group"> <label class="" for="">How many do you need?</label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: 17" type="number"
                                                name="cost_number" id="mc_material_qty">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group "><label>Why do we need this? </label><textarea
                                            placeholder="Example: We need this to replace the valve"
                                            class="form-control" rows="5" name="cost_description"
                                            id="mc_desc"></textarea></div>
                                </div>
                            </div>
                            <input type="hidden" name="costs_id" id="costs_id">
                            <input type="hidden" name="maintenance" id="m_id">

                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient mb-4">
                            <h4 class="onboarding-title display-8 text-center"></h4>
                            <hr>
                            <div class="row">
                                <div class="col-sm-12 col-12">
                                    <div class="form-group"> <label class='' for="">What is the total cost? (in
                                            USD)</label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: USD 10,000" type="number"
                                                name="cost_total" id="mc_cost">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label">Has this been paid for yet?</label>
                                        <select class="form-control" name="paid" id="mc_cost_status">
                                            <option value="paid">Yes</option>
                                            <option selected value="not paid">No</option>
                                        </select> </div>
                                </div>
                            </div>
                            <div class="row d-none paid_for_column">
                                <div class="col-sm-12">
                                    <div class="form-group  ">
                                        <label for=""> When was this paid for?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="date_with_end form-control editable past_date"
                                                placeholder="Select date" type="text" name="paid_date"
                                                id="mc_cost_date"></div>
                                    </div>
                                </div>
                            </div>


                            <div class="row d-none paid_for_column">
                                <div class="col-12">
                                    <div class="form-group required">
                                        <label class="control-label">How was the payment made?</label>
                                        <select class="form-control" required="required" name="paid_through"
                                            id="paid_through">
                                            <option selected value="cash">cash</option>
                                            <option value="Cashier's check">Cashier's check</option>
                                            <option value="Check">Check</option>
                                            <option value="Credit card">Credit card</option>
                                            <option value="Direct deposit">Direct deposit</option>
                                            <option value="Electronic payment">Electronic payment</option>
                                            <option value="Money order">Money order</option>
                                        </select> </div>
                                </div>

                            </div>
                            <div class="row d-none paid_for_column">
                                <div class="col-12 reference_row d-none">
                                    <div class="form-group required">
                                        <label class="control-label">What was the <span
                                                class="reference_title">reference number</span>?
                                        </label>
                                        <input class="form-control editable" type="text"
                                            placeholder="Select reference number" name="ref_no" id="ref_no">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="onboarding-slide">
                        <div class="onboarding-media"><img alt="" width="80px">
                        </div>
                        <div class="onboarding-content with-gradient">
                            <input type="hidden" name="cost_action_type" id="cost_action_type">
                            <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                            <div class="form-buttons-w d-flex flex-row justify-content-end">
                                <button class="btn btn-primary px-5 py-2" type="submit" id="submit_cost">Upload
                                    records</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div aria-hidden="true" data-backdrop="static" class="onboarding-modal modal fade animated" id="cost_modal"
    role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered modal-lg" role="document">
        <div class="modal-content">
            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                    class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
            <div class="onboarding-slider-w cost_main">
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class=" mt-5 onboarding-title display-10 fancy_text5 font-w600 lead text-center">
                            <span>Costs</span></h4>
                        <legend class='text-center'><span class='display-8 text-center text-primary '> </span> </legend>
                        <input type="hidden" name="cost_success_type" id="cost_success_type">
                        <input type="hidden" name="add_cost_id" id="add_cost_id">
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <div class="row mb-2 ">
                            <div class="d-flex justify-content-end col-12">
                                <button class="btn btn-primary  btn-rounded justify-content-end px-5 py-2"
                                    id="add_cost_button" type='button'><span>Click to add</span></button>
                            </div>
                        </div>

                        <div class="table-responsive" style="cursor: pointer;">
                            <table id='cost_table'
                                class="table table-lightborder table-heading display responsive nowrap"
                                data-turbolinks="false" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="text-left">Labour/Material</th>
                                        <th class="text-left">Total cost</th>
                                        <th class="text-left">Status</th>

                                        <th class="text-left"></th>
                                    </tr>
                                </thead>
                                <tbody class="text-left">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                        <div class="form-buttons-w d-flex flex-row justify-content-end">
                            <button class="btn btn-primary py-2 px-5" type="button" id="submit_final_cost">Continue
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div aria-hidden="true" data-backdrop="static" style='z-index:2000' data-tab="sub_modal"
    class="onboarding-modal modal fade animated" id="add_service_modal" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered" role="document">
        <form method="POST" id='add_service_form'>
            <div class="modal-content">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                        class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
                <div class="onboarding-slider-w service_sub sub_modal">
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-left fancy_text5 cost_title">Let's begin
                            </h4>
                            <hr>
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group ">
                                        <label class="control-label">Task assigned to</label>
                                        <select id='service_assigned_to' name="assigned_to"
                                            class=" form-control selectpicker show-tick form-control-sm1"
                                            data-live-search="true" data-size="4">
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label">Have they visited the location?</label>
                                        <select class="form-control" name="arrived" id="arrived">
                                            <option selected value="no">No</option>
                                            <option value="yes">yes</option>

                                        </select> </div>
                                </div>
                            </div>
                            <div class="row  ">
                                <div class="col-sm-12">
                                    <div class="form-group  ">
                                        <label class="text_visited">When are they scheduled to arrive?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="date_with_end form-control editable all_date"
                                                placeholder="Select date" type="text" name="scheduled_date"
                                                id="scheduled_date"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row row_visited d-none">
                                <div class="col-12">
                                    <div class="form-group  ">
                                        <label for="">When did they arrive?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="all_date form-control editable" placeholder="Select date"
                                                type="text" name="date_in" id="date_in"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row row_visited d-none">
                                <div class="col-md-6 col-12">
                                    <div class="form-group"> <label for="">Time in
                                        </label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: 8:00 AM" type="text"
                                                name="time_in" id="time_in">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-group"> <label for="">Time out
                                        </label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: 2:00 PM" type="text"
                                                name="time_out" id="time_out">
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <input type="hidden" name="service_id" id="service_id">
                            <input type="hidden" name="maintenance" id="s_id">

                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient mb-4">
                            <h4 class="onboarding-title display-8 text-center"></h4>
                            <hr>
                            <div class="row row_visited d-none">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label">Was the job completed when they left?</label>
                                        <select class="form-control" required="required" name="status"
                                            id="status_service">
                                            <option value="complete">Yes</option>
                                            <option value="in progress">Started but didn't finish</option>
                                            <option selected value="not started">Not yet started</option>
                                        </select> </div>
                                </div>
                            </div>
                            <div class="row d-none quantity_column">
                                <div class="col-sm-12 col-12">
                                    <div class="form-group"> <label class="" for="">How many do you need?</label>
                                        <div class="input-group mb-2 mb-sm-0">
                                            <input class="form-control" placeholder="Example: 17" type="number"
                                                name="cost_number" id="mc_material_qty">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group "><label>Action notes </label><textarea
                                            placeholder="Example:They fixed the electrical cable and handle the wiring that was there"
                                            class="form-control" rows="4" name="action_notes"
                                            id="action_notes"></textarea></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="onboarding-slide">
                        <div class="onboarding-media"><img alt="" width="80px">
                        </div>
                        <div class="onboarding-content with-gradient">
                            <input type="hidden" name="service_action_type" id="service_action_type">
                            <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                            <div class="form-buttons-w d-flex flex-row justify-content-end">
                                <button class="btn btn-primary px-5 py-2" type="submit" id="submit_service">Upload
                                    records</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div aria-hidden="true" data-backdrop="static" class="onboarding-modal modal fade animated" id="service_modal"
    role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered modal-lg" role="document">
        <div class="modal-content">
            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                    class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
            <div class="onboarding-slider-w cost_main">
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class=" mt-5 onboarding-title display-10 fancy_text5 font-w600 lead text-center">
                            <span>Tasks</span></h4>
                        <legend class='text-center'><span class='display-8 text-center text-primary '> </span> </legend>
                        <input type="hidden" name="service_success_type" id="service_success_type">
                        <input type="hidden" name="add_service_id" id="add_service_id">
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <div class="row mb-2 ">
                            <div class="d-flex justify-content-end col-12">
                                <button class="btn btn-primary  btn-rounded justify-content-end px-5 py-2"
                                    id="add_service_button" type='button'><span>Click to add</span></button>
                            </div>
                        </div>

                        <div class="table-responsive" style="cursor: pointer;">
                            <table id='service_table'
                                class="table table-lightborder table-heading display responsive nowrap"
                                data-turbolinks="false" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="text-left">Assigned to</th>
                                        <th class="text-left">Date</th>
                                        <th class="text-left">Status</th>

                                        <th class="text-left"></th>
                                    </tr>
                                </thead>
                                <tbody class="text-left">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                        <div class="form-buttons-w d-flex flex-row justify-content-end">
                            <button class="btn btn-primary py-2 px-5" type="button" id="submit_final_service">Continue
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% comment %} END costs
======================================================================================== {% endcomment %}
{% comment %} START documents
======================================================================================== {% endcomment %}
<div aria-hidden="true" data-backdrop="static" style='z-index:2000' class="onboarding-modal modal fade animated"
    data-tab="sub_modal" id="attachment_image_modal" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered" role="document">
        <form method="POST" id='attachment_image_form'>
            <div class="modal-content">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                        class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
                <div class="onboarding-slider-w attachment_slide sub_modal">
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-left fancy_text5">Attachment name</h4>
                            <hr>
                            <div class="row mb-4 ">
                                <div class="col-sm-12">
                                    <div class="form-group required">
                                        <label class="control-label">Attachment name</label>
                                        <input class="form-control editable" type="text"
                                            placeholder="Example:Bathroom sink" min="1" name="name" id="image_name">
                                    </div>
                                </div>
                            </div>
                            <div class="row ">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label">Is this a photo or video?</label>
                                        <select class="form-control" required="required" name="category"
                                            id="category_photo">
                                            <option selected value="photo">Photo</option>
                                            <option value="video">Video</option>
                                        </select> </div>
                                </div>
                            </div>
                            <input type="hidden" name="maintenance" id="attachment_id2">
                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-7 text-left fancy_text4">Click to attach</h4>
                            <hr>
                            {% comment %} <div class="mb-5">
                                <label for="" class='text-left col-sm-12  fancy_text3 text-secondary'> <span
                                        class='fancy_text4 text-primary'>Allowed types</span>| jpg,png,jpeg |</label>
                                <input type="file" name='document'
                                    class="form-control-file btn btn-outline-primary px-4 py-4" id="lease_file">
                            </div> {% endcomment %}
                            <div class="row my-4 row_video d-none">
                                <div class="col-sm-12">
                                    <div class="form-group required">
                                        <label class="control-label">Video url</label>
                                        <input class="form-control editable" type="text"
                                            placeholder="Example:https://www.youtube.com/watch?v=Zgnq1YHONNM" min="1"
                                            name="video" id="video">
                                    </div>
                                </div>
                            </div>
                            <div class="row row_photo my-4">
                                <label for="" style="font-size:15px"
                                    class='text-center col-sm-12  fancy_text3 text-black '>
                                    <span class='fancy_text4 text-primary font-w600'>Select a photo to upload </span>
                                </label>
                                <input type="file" name='photo'
                                    class="form-control-file btn-roundeds btn btn-outline-primary px-5 py-4" id="photo">
                            </div>

                            <!-- <div class="form-buttons-w d-flex flex-row justify-content-between">
                                <div class="cancel-process steps p-2 lead justify-content-start"><a href="#" aria-label="Close" data-dismiss="modal">Cancel the process</a></div>
                                <button class="btn btn-primary px-5 py-3 step-button justify-content-end" id="submit_attachment" type="submit">Upload attachment</button>
                            </div> -->
                        </div>
                    </div>
                    <div class="onboarding-slide">

                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                            <div class="form-buttons-w d-flex flex-row justify-content-end">
                                <button class="btn btn-primary py-2 px-5" type="submit" id="submit_attachment">Upload
                                    attachment</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </form>
    </div>
</div>

<div aria-hidden="true" data-backdrop="static" class="onboarding-modal modal fade animated" id="attachment_modal"
    role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered modal-lg" role="document">
        <div class="modal-content">
            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                    class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
            <div class="onboarding-slider-w attachment_main">
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class=" mt-5 onboarding-title fancy_text5 display-10 font-w600 fancy_text5 lead text-center"
                            sdtyle="color:#B3B6B7 "><span>Photos/Videos</span></h4>
                        <legend class='text-center'><span class='display-8 text-center text-primary '> </span> </legend>
                        <input type="hidden" name="attachment_success_type" id="attachment_success_type">
                        <input type="hidden" name="attachment_id" id="attachment_id">
                        <input type="hidden" name="attachment_property" id="attachment_property">
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <div class="row mb-2 ">
                            <div class="d-flex justify-content-end col-12">
                                <button class="btn btn-primary btn-rounded justify-content-end px-5 py-2"
                                    id="attachment_button" type='button'><span>Click to attach</span></button>
                            </div>
                        </div>
                        <div class="table-responsive" style="cursor: pointer;">
                            <table id='attachment_table'
                                class="table table-lightborder display responsive nowrap table-heading"
                                data-turbolinks="false" style="width:100%">
                                <thead>
                                    <tr>
                                        <th class="text-left">Attachment</th>
                                        <th class="text-left">type</th>
                                        <th class="text-left">name</th>
                                        <th class="text-left"></th>
                                    </tr>
                                </thead>
                                <tbody class="text-left">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="onboarding-slide">
                    <div class="onboarding-content with-gradient">
                        <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                        <div class="form-buttons-w d-flex flex-row justify-content-end">
                            <button class="btn btn-primary py-2 px-5" type="button" id="submit_final_attachment">Continue
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% comment %} END documents
======================================================================================== {% endcomment %}

<div aria-hidden="true" data-backdrop="static" style='z-index:2000' class="onboarding-modal modal fade animated"
    id="create_request_modal" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-centered modal-lg" role="document">
        <form method="POST" id='create_request_form'>
            <div class="modal-content">
                <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span
                        class="close-label">Close</span><span class="os-icon os-icon-close"></span></button>
                <div class="onboarding-slider-w">

                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-10 text-left fancy_text5 request_title">Let's begin</h4>
                            <hr>


                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group ">
                                        <label class="control-label">Select a property/building</label>
                                        <select id='unit_maintenance' name="unit"
                                            class=" form-control selectpicker show-tick form-control-sm1"
                                            data-live-search="true" data-size="4">
                                        </select>
                                    </div>
                                </div>
                            </div>



                            <input type="hidden" id="request_data_id" name="id">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label">Kindly select the category</label>
                                        <select class="form-control selectpicker" required="required" name="category"
                                            id="request_data_category">
                                            <option selected disabled>Select a category</option>
                                            <option value="plumbing" data-subtext="(Tiolets, sinks, showers, leaks)"
                                                class="display-7sm">Plumbing</option>
                                            <option value="appliances"
                                                data-subtext="(Refrigirator, oven, water heater, cooling fans)"
                                                class="display-7sm">Appliances</option>
                                            <option value="electrical"
                                                data-subtext="(Power outlets, fuse, bulbs, Alarms, Internet,Doorbell)"
                                                class=" display-7sm">Electrical</option>
                                            <option value="pest control" data-subtext="(Ants,termites, rodents)"
                                                class="display-7sm">Pest control</option>
                                            <option value="house hold"
                                                data-subtext="(Doors,windows,ceiling,floor,cabinets)"
                                                class="display-7sm">House hold</option>
                                            <option value="outdoor"
                                                data-subtext="(Landscape,fencing,garbage,parking,pool)"
                                                class="display-7sm">Outdoor</option>
                                            <option value="Cleaning services"
                                                data-subtext="(General cleaning,Builders’ Clean,End of Tenancy Clean,windows)"
                                                class="display-7sm">Cleaning services</option>
                                            <option value="other" class="display-7sm">Others</option>
                                        </select> </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="control-label">What is the priority</label>
                                        <select class="form-control " name="priority" id="request_priority">
                                            <option value="high">High</option>
                                            <option selected value="normal">Normal</option>
                                            <option value="low">Low</option>
                                        </select> </div>
                                </div>
                            </div>

                            <div class="row d-none custom_label">
                                <div class="col-sm-12">
                                    <div class="form-group  ">
                                        <label for=""> What type of issue is this?</label>
                                        <div><input autocomplete="off" class="form-control"
                                                placeholder="Example: Loud noise" type="text" name="name"
                                                id="request_data_custom"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group "><label>Describe the issue </label><textarea
                                            placeholder="Example: My toilet is leaking" class="form-control" rows="5"
                                            name="description" id="request_data_desc"></textarea></div>
                                </div>
                            </div>

                        </div>

                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-center"></h4>
                            <hr>
                            <div class="row">
                                <div class="col-md-6 col-12">
                                    <div class="form-group ">
                                        <label class="control-label">Request type</label>
                                        <select class="form-control" required="required" name="request_type"
                                            id="request_type">
                                            <option value="Non resident">Non resident</option>
                                            <option value="resident">Resident</option>

                                        </select> </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-group  ">
                                        <label for=""> When was this issue reported?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="past_date form-control editable" placeholder="Select date"
                                                type="text" name="reported_on" id="request_data_date"></div>
                                    </div>
                                </div>

                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label">Has the service been completed?</label>
                                        <select class="form-control" required="required" name="status"
                                            id="request_data_solved">
                                            <option value="complete">Yes</option>
                                            <option value="in progress">In progress</option>
                                            <option selected value="not started">Not yet started</option>
                                        </select> </div>
                                </div>
                            </div>
                            <div class="row ">
                                <div class="col-md-6 col-12 class_data_begun_date d-none">
                                    <div class="form-group  ">
                                        <label for=""> When did they begin?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="date_with_end form-control editable past_date" value=""
                                                placeholder="Select date" type="text" name="begun_on"
                                                id="request_data_begun_date"></div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12 class_data_solved_date d-none">
                                    <div class="form-group  ">
                                        <label for=""> When was it completed?</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="date_with_end form-control editable past_date" value=""
                                                placeholder="Select date" type="text" name="solved_on"
                                                id="request_data_solved_date"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row row_enter">
                                <div class="col-sm-12">
                                    <div class="form-group ">
                                        <label class="control-label text_enter">When can someone be sent?</label>
                                        <select class="form-control" required="required" name="authorized_enter"
                                            id="authorized_enter">
                                            <option selected value="anytime">Anytime</option>
                                            <option value="specific date">Specific date</option>
                                        </select> </div>
                                </div>
                            </div>
                            <div class="row row_specific_dates d-none">
                                <div class="col-md-6 col-12">
                                    <div class="form-group  ">
                                        <label for=""> Between</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="all_date form-control editable" placeholder="Select date"
                                                type="text" name="authorized_enter_start" id="authorized_enter_start">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-group  ">
                                        <label for="">And</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="all_date form-control editable" placeholder="Select date"
                                                type="text" name="authorized_enter_end" id="authorized_enter_end"></div>
                                    </div>
                                </div>
                            </div>
                            <br>
                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-center"></h4>
                            <hr>
                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group ">
                                        <label class="control-label">Assigned to</label>
                                        <select id='assigned_to' name="assigned_to"
                                            class=" form-control selectpicker show-tick form-control-sm1"
                                            data-live-search="true" data-size="4">
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 col-12">
                                    <div class="form-group ">
                                        <label class="control-label"><span class="is_was">Is</span> there an alarm
                                            ?</label>
                                        <select class="form-control" required="required" name="authorized_alarm"
                                            id="authorized_alarm">
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select> </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-group ">
                                        <label class="control-label"><span class="is_was">Is</span> there a pet
                                            ?</label>
                                        <select class="form-control" required="required" name="authorized_pet"
                                            id="authorized_pet">
                                            <option value="Yes">Yes</option>
                                            <option value="No">No</option>
                                        </select> </div>
                                </div>
                            </div>
                            <br></br>
                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-left">Budget for the project</h4>
                            <hr>
                            <div class="row">
                                <div class="col-md-6 col-12">
                                    <div class="form-group  ">
                                        <label for=""> Expected to start on</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="all_date form-control editable" placeholder="Select date"
                                                type="text" name="budget_start" id="budget_start">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-12">
                                    <div class="form-group  ">
                                        <label for="">Expected to end on</label>
                                        <div class="date-input"><input autocomplete="off"
                                                class="all_date form-control editable" placeholder="Select date"
                                                type="text" name="budget_end" id="budget_end"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group  ">
                                        <label class="control-label">Budgeted amount</label>
                                        <div><input autocomplete="off" class="form-control"
                                                placeholder="Enter the budget amount" type="text" name="budget_amount"
                                                id="budget_amount"></div>
                                    </div>
                                </div>
                            </div>


                            <br></br>
                        </div>
                    </div>
                    <div class="onboarding-slide">
                        <div class="onboarding-content with-gradient">
                            <h4 class="onboarding-title display-8 text-left">Lastly</h4>
                            <hr>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group "><label>Special request </label><textarea
                                            placeholder="Enter any special instructions" class="form-control" rows="5"
                                            name="special_instructions" id="special_instructions"></textarea></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="onboarding-slide">

                        <div class="onboarding-content with-gradient">
                            <input type="hidden" value="add" id="action_type" name="action_type">
                            <h4 class="onboarding-title lead display-8 text-center">Are you done?</h4>
                            <div class="form-buttons-w d-flex flex-row justify-content-end">
                                <button class="btn btn-primary px-5 py-2" type="submit" id="submit_request">Upload
                                    records</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>



{% endblock modal %}
{% block content %}
<div class="content-body" style="min-height: 828px;">
    <!-- row -->
    <div class="container-fluid">

        <div class="card mx-3">
            <div class="card-header d-block mx-3 text-center">
                <h5 class="card-titles display-4 custom-card-title ">Renovations</h5>

            </div>
        </div>

        <div class="row">
            <div class="col-xl-12">
                <div class="col-12">

                    <div class="card px-3">
                        {% include 'partials/_table_extra.html' with button_class="" button_id="create_request_button" button_text="Click to add" total_class="total_requests" total_text="renovations"  %}

                        {% comment %} <div class="table-extra my-2">
                            <div class="row my-4 mx-3 pt-47 d-flex justify-content-end">
                                <button class="btn btn-primary  py-2 px-5 btn-rounded" type="button"
                                    id="test_cost_button"><span>Click to test</span></button>
                            </div>


                        </div> {% endcomment %}
                        {% comment %} <div class="table-extra my-2">
                            <div class="row my-4 mx-3 pt-47 d-flex justify-content-end">
                                <button class="btn btn-primary  py-2 px-5 btn-rounded test_service_button" type="button"
                                    id="test_service_button"><span>Click to test sev</span></button>
                            </div>
                        </div>
                        <div class="table-extra my-2">
                            <div class="row my-4 mx-3 pt-47 d-flex justify-content-end">
                                <button class="btn btn-primary  py-2 px-5 btn-rounded test_doc_button" type="button"
                                    id="test_service_button"><span>Click to test doc</span></button>
                            </div>
                        </div> {% endcomment %}


                        <div class="card-body">
                            <div class="table-responsive">

                                <table id="requests_table" class="display min-w850">
                                    <thead>
                                        <tr>

                                            <th>Property </th>
                                            <th>Renovations for</th>
                                            <th>Category</th>
                                            <th>Reported on</th>
                                            <th>Budget</th>
                                            <th>Status</th>
                                            <th></th>


                                    </thead>
                                    <tbody>


                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

{% block scripts %}
{% include 'search/_select_options.html' %}
{% include 'partials/_date.html' %}
<link rel="stylesheet" href="https://cdn.datatables.net/rowgroup/1.1.1/css/rowGroup.dataTables.min.css">
<script src="https://cdn.datatables.net/rowgroup/1.1.1/js/dataTables.rowGroup.min.js"></script>
<script>



 

    $(document).on('click', '#next_submit', function () {
        var next_value = $('#next_value').val();
        var next_id = $('#next_id').val();
     
        if (next_value == "cost") {
            $('#add_cost_id').val(next_id);
            cost_function(next_id);
            $('#cost_modal').modal('show');
        }
        if (next_value == "attachment") {
            $('#attachment_id').val(next_id);
            attachment_function(next_id);
            $('#attachment_modal').modal('show');
        }
        if (next_value == "service") {
            $('#add_service_id').val(next_id);
            service_function(next_id);
            $('#service_modal').modal('show');
        }
        if (next_value == "nothing") {
             $('#success_text').text("Remeber that you can edit this data any time");
             $('#success_alert').modal('show');
        }
        $('#next_modal').modal('hide');
    });  
  //  $('#next_modal').modal('show');
    $(document).ready(function () {
        f_requests_table();
        select_option.units('#unit_maintenance');
        select_option.contractor('#assigned_to');
        select_option.contractor('#service_assigned_to');
    });
 
function add_request(){
    $('#create_request_form')[0].reset();
    $('#filter_request_modal').modal('hide');
    $('#action_type').val('add');
    $('.is_was').text('Is');
    $('.request_title').text("Let's begin");
    select_option.units('#unit_maintenance');
    select_option.contractor('#assigned_to');
    $('.class_data_solved_date').addClass('d-none');
    $('.class_data_begun_date').addClass('d-none');
    $('#budget_amount').val(0);
    $('#create_request_modal').modal('show');
}

  {% if modal%}
  add_request();
  
  {% endif %}
    $(document).on('click', '#create_request_button', function () {
        add_request();
    });


    $(document).on('submit', '#create_request_form', function (event) {

        var action_type = $('#action_type').val();

        if (action_type == 'add') {
            var method = 'POST';
            var url = '{% url "services:maintenance-listcreate" %}';
        }
        if (action_type == 'edit') {
            var id = $('#request_data_id').val();
            var method = 'PUT';
            var url = "{% url 'services:maintenance-rud' id=12345 %}".replace(/12345/, id).toString();
        }
        var form_data = new FormData(this);
        event.preventDefault();
        $.ajax({
            method: method,
            url: url,
            data: form_data,
            contentType: false,
            processData: false,
            dataType: "json",
            beforeSend: function () {
                $('#submit_request').attr('disabled', 'disabled');
                $("#submit_request").html("Please wait");
            },
            success: function (data) {
                $('#submit_request').attr('disabled', false);
                $("#submit_request").html("Upload records");
                if (data.success) {
                    f_requests_table();
                    $('#create_request_modal').modal('hide');
                    $('#cost_success_type').val(action_type);
                    $('#service_success_type').val(action_type);
                    $('#attachment_success_type').val("add");
                    if (action_type == "add") {
                        $('.next_type').text('Add');
                        $('#next_id').val(data.response.id);
                        $('#next_value').val('cost').change();
                        $('#next_modal').modal('show');
                      
                    } else if (action_type == "edit") {
                        alert("edit");
                        //$('#success_text').text(data.success);
                        //$('#success_alert').modal('show');
                        $('.next_type').text('Edit');
                        $('#next_id').val(data.response.id);
                        $('#next_value').val('cost').change();
                        $('#next_modal').modal('show');
                    } else {
                        $('#oops_text').text("Something went wrong, try again later");
                        $('#oops_alert').modal('show');
                    }
                }
                if (data.error) {
                    $('#oops_text').text(data.error);
                    $('#oops_alert').modal('show');
                }
            },
            error: function (jqXhr) {
                $('#submit_request').attr('disabled', false);
                $("#submit_request").html("Upload records");
                $('#oops_text').text("Something went wrong, try again later");
                $('#oops_alert').modal('show');
            }
        });
    });
    $(document).on('change', '#authorized_enter', function () {
        var choice = $(this).val();
        if (choice == "specific date") {
            $('.row_specific_dates').removeClass('d-none');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
   
        } else {
            $('.row_specific_dates').addClass('d-none');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        }
    });
    $(document).on('change', '#request_data_solved', function () {
        var request_data_solved = $(this).val();
        if (request_data_solved == "solved") {
            $('.is_was').text('Was');
            $('.text_enter').text('When was the contractor allowed to come?');
            $('.maintenance_decision').addClass('d-none');
            $('.class_data_begun_date').removeClass('d-none');
           // $('.row_enter').addClass('d-none');
            $('.class_data_solved_date').removeClass('d-none');
            $('#request_data_begun_date').val("");
            $('#request_data_solved_date').val("");
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        } 
        else if(request_data_solved == "in progress"){
            $('.is_was').text('Was');
           // $('.row_enter').removeClass('d-none');
           $('.text_enter').text('When was the contractor allowed to come?');
            $('.class_data_solved_date').addClass('d-none');
            $('.class_data_begun_date').removeClass('d-none');
            $('.maintenance_decision').addClass('d-none');
            $('#request_data_solved_date').val("");
            $('#request_data_begun_date').val("");
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        }
        else {
            $('.is_was').text('Is');
           // $('.row_enter').removeClass('d-none');
            $('.text_enter').text('When can someone be sent?');
            $('.class_data_solved_date').addClass('d-none');
            $('.class_data_begun_date').addClass('d-none');
            $('.maintenance_decision').removeClass('d-none');
            $('#request_data_solved_date').val("");
            $('#request_data_begun_date').val("");
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        }
        $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
    });
    $(document).on('click', '.edit_maintenance', function () {
       
        //select_option.unit_maintenance('#unit_maintenance');
        var id = $(this).attr("id");

        $.ajax({
            url: "{% url 'services:maintenance-rud' id=12345 %}".replace(/12345/, id).toString(),
            method: "GET",
            dataType: "json",
            data: {
                id: id
            },

            success: function (data) {
                $('.request_title').text(data.name);
                $('#request_data_id').val(data.id);
                $('#action_type').val('edit');
                $('#unit_maintenance').val(data.unit).change();
                $('#request_data_category').val(data.category).change();
                $('#request_data_custom').val(data.name);
                $('#request_data_desc').val(data.description);
                $('#request_priority').val(data.priority).change();
                $('#request_data_date').val(data.reported_on);
                $('#request_data_solved').val(data.status).change();

                $('#request_type').val(data.request_type).change();
                $('#authorized_enter').val(data.authorized_enter).change();
                $('#authorized_alarm').val(data.authorized_alarm).change();
                $('#authorized_pet').val(data.authorized_pet).change();
                $('#special_instructions').val(data.special_instructions);
                $('#authorized_enter_start').val(data.authorized_enter_start);
                $('#budget_start').val(data.budget_start);
                $('#budget_end').val(data.budget_end);
                $('#budget_amount').val(data.budget_amount);
                $('#authorized_enter_end').val(data.authorized_enter_end);
                if (data.status == "solved") {
                    $('.is_was').text('Was');
                    $('.maintenance_decision').addClass('d-none');
                    $('.class_data_solved_date').removeClass('d-none');
                    $('.class_data_begun_date').removeClass('d-none');
                    $('#request_data_solved_date').val(data.solved_on);
                    $('#request_data_begun_date').val(data.begun_on);
                } 
                else if (data.status == "in progress") {

                    
                    $('.is_was').text('Was');
                    $('.maintenance_decision').addClass('d-none');
                    $('.class_data_begun_date').removeClass('d-none');
                    $('.class_data_solved_date').addClass('d-none');
                    $('#request_data_solved_date').val(data.solved_on);
                    $('#request_data_begun_date').val(data.begun_on);
                } 
                
                else {
                    $('.is_was').text('Is');
                    $('.maintenance_decision').removeClass('d-none');
                    $('.class_data_solved_date').addClass('d-none');
                    $('.class_data_begun_date').addClass('d-none');
                    $('#request_data_solved_date').val("");
                    $('#request_data_begun_date').val("");
                }
                $('#create_request_modal').modal('show');

            }
        })
    });
    $(document).on('click', '.add_property', function () {
        url_path = "{% url 'property:index'%}";
        window.open(url_path);
        $('#create_request_modal').modal('hide');
    });
    $(document).on('click', '.remove_maintenance', function () {
        var data = $(this).attr("id");
        var data_split = data.split(",");
        var request_id = data_split[0];
        var mame = data_split[1];

        $('#confirm_title').text("Are you sure?");
        $('#confirm_extra').text("The image attachments and costs of the " + name +
            " problem will be deleted as well");
        $('#confirm_button').text("Confirm removal");
        $('#confirm_alert').modal('show');
        $('#confirmYes').off().on('click', function () {
            $.ajax({
                url: "{% url 'services:maintenance-rud' id=12345 %}".replace(/12345/,
                    request_id).toString(),
                method: "DELETE",
                dataType: "json",
                data: {
                    request_id: request_id,


                },
                success: function (data) {
                    if (data.success) {
                        $('#confirm_alert').modal('hide');
                        $('#success_text').text(data.success);
                        $('#success_alert').modal('show');
                        f_requests_table();
                    }
                    if (data.error) {
                        $('#oops_text').text(data.error);
                        $('#oops_alert').modal('show');
                        $('#confirm_alert').modal('hide');
                    }
                },
                error: function (jqXhr) {
                    $('#oops_text').text("Something went wrong, try again later");
                    $('#oops_alert').modal('show');
                    $('#confirm_alert').modal('hide');
                }

            });
        });
        $('#confirmNo').off().on('click', function () {
            $('#confirm_alert').modal('hide');
        });
    });
    $(document).on('change', '#request_data_category', function () {
        var request_type = $(this).val();
        if (request_type == "other") {
            $('.custom_label').removeClass('d-none');
        } else {
            $('.custom_label').addClass('d-none');
            $('#request_data_custom').val("");
        }
        $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
    });

    function f_requests_table() {
        url_data = '{% url "services:maintenance-listcreate" %}';
        $(".fcp-group-contents").addClass('d-none');
        $(".maintenance_requests_record").removeClass('d-none');
        $(".third-floated-btn").removeClass('d-none');
        $(".filter_label").text('Requests');
        $('#requests_table').DataTable({
            processing: true,
            serverSide: true,
            "destroy": true,
            "bAutoWidth": false,
            "ordering": false,
            "oLanguage": {
                "sEmptyTable": "No maintenance request added",
                "sStripClasses": "",
                "sSearch": "",
                "sSearchPlaceholder": "search...",
                "sLengthMenu": '<span>Rows per page:</span><select class="browser-default">' +
                    '<option value="10">10</option>' +
                    '<option value="20">20</option>' +
                    '<option value="30">30</option>' +
                    '<option value="40">40</option>' +
                    '<option value="50">50</option>' +
                    '<option value="50">100</option>' +

                    '</select></div>'
            },
            "order": [[0, 'asc']],
           
            "rowGroup": {
                "dataSrc": 0
            },

            initComplete: function () {
                var btns = $('.dt-button');
                btns.removeClass('dt-button');
            },
            "ajax": {
                "url": url_data,


            },
            'columnDefs': [{
                'width': '20%',
                'targets': 1
            },
            {
                "visible": false,
                "targets": 0,
            },
            
            
            ],
            "bPaginate": true,
            "bProcessing": true,
            "pageLength": 10,
            "fnDrawCallback": function () {
                $('.total_requests').html(this.fnSettings().fnRecordsTotal());
            }

        });
    }

    //start documents---------------------------------------------------- 
    $("#upload_file").change(function () {
        if ($("#upload_file").val()) {
            $(".attachment_name").html("A photo has been uploaded.");
        } else {
            $(".attachment_name").html("Click if you want to upload a photo of the problem.");

        }

    });


    $(document).on('click', '.test_doc_button', function () {
        var maintenance = $(this).attr("id");
        attachment_function(maintenance);
        $('#attachment_success_type').val("edit");
        $('#attachment_modal').modal('show');
    });
    $(document).on('click', '.attach_photos', function () {
        var maintenance = $(this).attr("id");
        attachment_function(maintenance);
        $('.next_type').text('Edit');
        $('#next_id').val(maintenance);
        $('#next_value').val('nothing').change();
       
        $('#attachment_success_type').val("edit");
        $('#attachment_modal').modal('show');
    });
    $(document).on('click', '#attachment_button', function () {
        $('#attachment_image_form')[0].reset();
        $('#category_photo').val('photo').change();
        $('#attachment_id2').val($('#attachment_id').val());
        $('#attachment_property2').val($('#attachment_property').val());
        $('#attachment_image_modal').modal('show');
    });
    $(document).on('change', '#category_photo', function () {
        var request_type = $(this).val();
        if (request_type == "photo") {
            $('.row_photo').removeClass('d-none');
            $('.row_video').addClass('d-none');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        } else  {
            $('.row_photo').addClass('d-none');
            $('.row_video').removeClass('d-none');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        }
      
    });
    $(document).on('submit', '#attachment_image_form', function (event) {
        var form_data = new FormData(this);
        url = '{% url "services:document-listcreate" %}';

        event.preventDefault();
        $.ajax({
            method: 'POST',
            url: url,
            data: form_data,
            contentType: false,
            processData: false,
            dataType: "json",
            beforeSend: function () {
                $('#submit_attachment').attr('disabled', 'disabled');
                $("#submit_attachment").html("Please wait");
            },
            success: function (data) {
                $('#submit_attachment').attr('disabled', false);
                $("#submit_attachment").html("Upload attachment");
                if (data.success) {
                    attachment_function(data.response.maintenance)
                    $('#success_text').text(data.success);
                    $('#success_alert').modal('show');
                    $('#attachment_image_modal').modal('hide');

                }
                if (data.error) {
                    $('#oops_text').text(data.error);
                    $('#oops_alert').modal('show');
                }
            },
            error: function (jqXhr) {
                $('#attachment_image_modal').modal('hide');
                $('#submit_attachment').attr('disabled', false);
                $("#submit_attachment").html("Upload records");
                $('#oops_text').text("Something went wrong, try again later");
                $('#oops_alert').modal('show');

            }
        });
    });
    $(document).on('click', '.remove_document', function () {
        var data = $(this).attr("id");
        var data_split = data.split(",");
        var id = data_split[0];
        var maintenance = data_split[1];
        $('#confirm_title').text("Are you sure?");
        $('#confirm_extra').text("Confirming the removal of this image");
        $('#confirm_button').text("Confirm removal");
        $('#confirm_alert').modal('show');
        $('#confirmYes').off().on('click', function () {
            $.ajax({
                url: "{% url 'services:document-rud' id=12345 %}".replace(/12345/, id)
                    .toString(),
                method: "DELETE",
                dataType: "json",

                success: function (data) {
                    if (data.success) {
                        attachment_function(maintenance);
                        $('#confirm_alert').modal('hide');
                        f_requests_table();
                    }
                    if (data.error) {
                        $('#oops_text').text(data.error);
                        $('#oops_alert').modal('show');
                        $('#confirm_alert').modal('hide');
                    }
                },
                error: function (jqXhr) {
                    $('#oops_text').text("Something went wrong, try again later");
                    $('#oops_alert').modal('show');
                    $('#confirm_alert').modal('hide');
                }

            });
        });
        $('#confirmNo').off().on('click', function () {
            $('#confirm_alert').modal('hide');
        });
    });

    function attachment_function(maintenance) {
        url_data = '{% url "services:document-listcreate" %}';
        $('#attachment_table').DataTable({
            "destroy": true,
            "bAutoWidth": false,
            "ordering": false,
            "oLanguage": {
                "sEmptyTable": "No attachment added",
                "sStripClasses": "",
                "sSearch": "",
                "sSearchPlaceholder": "search...",
                "sLengthMenu": '<span>Rows per page:</span><select class="browser-default">' +
                    '<option value="10">10</option>' +
                    '<option value="20">20</option>' +
                    '<option value="30">30</option>' +
                    '<option value="40">40</option>' +
                    '<option value="50">50</option>' +
                    '<option value="50">100</option>' +

                    '</select></div>'
            },
            initComplete: function () {
                var btns = $('.dt-button');
                btns.removeClass('dt-button');
            },
            "ajax": {
                "url": url_data,

                "data": {
                    "maintenance": maintenance,

                },
            },
            "searching": false,
            "bPaginate": false,
            "bInfo": false,
            "bProcessing": true,
            "scrollCollapse": true,
            "paging": false,

        });
        jQuery('#attachment_table').wrap('<div class="dataTables_scroll" />');
        $('#attachment_table').css('wdith', '100%');
        $('#attachment_table').css('min-height', '200px');
        $('#attachment_id').val(maintenance);
    }

    //end documents---------------------------------------------------- 

    //start costs----------------------------------------------------

    $(document).on('change', '#mc_cost_status', function () {
        var request_type = $(this).val();
        if (request_type == "paid") {
            $('.paid_for_column').removeClass('d-none');
            $('.was_is').text('was this');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');

        } else if (request_type == "not paid") {
            $('.paid_for_column').addClass('d-none');
            $('#mc_cost_date').val("");
            $('.was_is').text('is this');
            $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
        }
      
    });
    $(document).on('click', '#submit_final_attachment', function () {

        $('#next_value').val('cost').change();
        $('#next_modal').modal('show');
        $('#attachment_modal').modal('hide');

    });
    $(document).on('click', '#submit_final_cost', function () {

        $('#next_value').val('service').change();
        $('#next_modal').modal('show');
        $('#cost_modal').modal('hide');
    });
    $(document).on('click', '#submit_final_service', function () {

        $('#next_value').val('attachment').change();
        $('#next_modal').modal('show');
        $('#service_modal').modal('hide');
    });
    $(document).on('change', '#paid_through', function () {
        var payment_option = $(this).val();

        if (payment_option == 'cash') {

            $("#ref_no").attr("placeholder", "(ignore me)");
            $('.reference_title').text("(ignore me)");
            $('.reference_row').addClass("d-none");


        } else if (payment_option == "Cashier's check" || payment_option == 'Check') {
            $("#ref_no").attr("placeholder", "Check number");
            $('.reference_title').text("Check number");
            $('.reference_row').removeClass("d-none");
        } else {
            $("#ref_no").attr("placeholder", "Reference number");
            $('.reference_title').text("Reference number");
            $('.reference_row').removeClass("d-none");
        }
        $('.onboarding-modal .onboarding-slider-w').slick('setPosition');
    });
    $(document).on('click', '.cost_button', function () {
        var data = $(this).attr("id");
        var maintenace = data;

        cost_function(maintenace);
        $('.next_type').text('Edit');
        $('#next_id').val(maintenace);
        $('#next_value').val('nothing').change();
        $('#cost_success_type').val("edit");
        $('#submit_final_cost').text('Continue');
        $('#cost_modal').modal('show');

    });
    
    $(document).on('click', '.service_button', function () {
        var data = $(this).attr("id");
        var maintenace = data;
        service_function(maintenace);
        $('.next_type').text('Edit');
        $('#next_id').val(maintenace);
        $('#next_value').val('nothing').change();
        $('#service_success_type').val("edit");
        $('#submit_final_service').text('Continue');
        $('#service_modal').modal('show');
    });
    $(document).on('click', '#add_service_button', function () {
        $('#add_service_form')[0].reset();
        $('#service_action_type').val("add");
        $('#s_id').val($('#add_service_id').val());
        $('#add_service_modal').modal('show');
    });
    $(document).on('change', '#arrived', function () {
        var choice = $(this).val();
        if (choice == "yes") {
            $('.row_visited').removeClass('d-none');
            $('.text_visited').text('When were they scheduled to arrive?');
            $('#add_service_modal .service_sub').slick('setPosition');
   
        } else {
            $('.row_visited').addClass('d-none');
            $('.text_visited').text('When are they scheduled to arrive?');
          
            $('#add_service_modal .service_sub').slick('setPosition');
        }
    });
    $(document).on('click', '.edit_service', function () {
        $('#add_service_form')[0].reset();

        var id = $(this).attr("id");
        $.ajax({
            url: "{% url 'services:services-rud' id=12345 %}".replace(/12345/, id).toString(),
            method: "GET",

            data: {
                id: id
            },
            dataType: "json",
            success: function (data) {
                 
              
                $('#service_id').val(id);
                $('#service_action_type').val('edit');
                $('#s_id').val(data.maintenance);
                $('#assigned_to').val(data.assigned_to);
                $('#scheduled_date').val(data.scheduled_date);
                $('#date_in').val(data.date_in);
                $('#time_in').val(data.time_in);
                $('#time_out').val(data.time_out);
                $('#action_notes').val(data.action_notes);
                $('#status_service').val(data.status).change();
                $('#arrived').val(data.arrived).change();
                $('#add_service_modal').modal('show');

            }
        })
    });
    $(document).on('submit', '#add_service_form', function (event) {
        var action_type = $('#service_action_type').val()
        if (action_type == 'add') {
            var method = 'POST';
            var url = '{% url "services:services-listcreate" %}';
        }
        if (action_type == 'edit') {
            var id = $('#service_id').val();
            var method = 'PUT';
            var url = "{% url 'services:services-rud' id=12345 %}".replace(/12345/, id).toString();
        }
        var form_data = new FormData(this);
        event.preventDefault();
        $.ajax({
            method: method,
            url: url,
            data: form_data,
            contentType: false,
            processData: false,
            dataType: "json",
            beforeSend: function () {
                $('#submit_service').attr('disabled', 'disabled');
                $("#submit_service").html("Please wait");
            },
            success: function (data) {
                $('#submit_service').attr('disabled', false);
                $("#submit_service").html("Upload records");
                if (data.success) {
                    service_function(data.response.maintenance);
                    $('#add_service_modal').modal('hide');
                    $('#success_text').text(data.success);
                    $('#success_alert').modal('show');
                  //  f_requests_table();
                }
                if (data.error) {
                    $('#oops_text').text(data.error);
                    $('#oops_alert').modal('show');
                }
            },
            error: function (jqXhr) {
                $('#submit_service').attr('disabled', false);
                $("#submit_service").html("Upload records");
                $('#oops_text').text("Something went wrong, try again later");
                $('#oops_alert').modal('show');

            }
        });
    });
    $(document).on('click', '.remove_service', function () {
        var data = $(this).attr("id");
        var data_split = data.split(",");
        var id = data_split[0];
        var maintenance = data_split[1];
        $('#confirm_title').text("Are you sure?");
        $('#confirm_extra').text("Confirming the removal of this service process");
        $('#confirm_button').text("Confirm removal");
        $('#confirm_alert').modal('show');
        $('#confirmYes').off().on('click', function () {
            $.ajax({
                url: "{% url 'services:services-rud' id=12345 %}".replace(/12345/, id)
                    .toString(),
                method: "DELETE",
                dataType: "json",
                data: {
                    id: id,
                },
                success: function (data) {
                    if (data.success) {
                        service_function(maintenance);
                        $('#confirm_alert').modal('hide');
                      //  f_requests_table();
                    }
                    if (data.error) {
                        $('#oops_text').text(data.error);
                        $('#oops_alert').modal('show');
                        $('#confirm_alert').modal('hide');
                    }
                },
                error: function (jqXhr) {
                    $('#oops_text').text("Something went wrong, try again later");
                    $('#oops_alert').modal('show');
                    $('#confirm_alert').modal('hide');
                }

            });
        });
        $('#confirmNo').off().on('click', function () {
            $('#confirm_alert').modal('hide');
        });
    });

    function service_function(maintenance) {
        url_data = '{% url "services:services-listcreate" %}';
        $('#service_table').DataTable({
            "destroy": true,
            "bAutoWidth": false,
            // "bLengthChange": false,
            "ordering": false,
            "oLanguage": {
                "sEmptyTable": "No task added",
                "sStripClasses": "",
                "sSearch": "",
                "sSearchPlaceholder": "search...",
                "sLengthMenu": '<span>Rows per page:</span><select class="browser-default">' +
                    '<option value="10">10</option>' +
                    '<option value="20">20</option>' +
                    '<option value="30">30</option>' +
                    '<option value="40">40</option>' +
                    '<option value="50">50</option>' +
                    '<option value="50">100</option>' +

                    '</select></div>'
            },
            initComplete: function () {
                var btns = $('.dt-button');
                btns.removeClass('dt-button');
            },
            "ajax": {
                "url": url_data,

                "data": {
                    "maintenance": maintenance,
                },
            },
            "searching": false,
            "bPaginate": false,
            "bInfo": false,
            "bProcessing": true,
            "scrollCollapse": true,
            "paging": false,

        });
        jQuery('#service_table').wrap('<div class="dataTables_scroll" />');
        $('#service_table').css('wdith', '100%');
        $('#service_table').css('min-height', '200px');
        $('#add_service_id').val(maintenance);
    }

    //--------------------------------------------------------------------------------------------
    $(document).on('click', '#test_cost_button', function () {
        var data = $(this).attr("id");
        var attachment = data;
        cost_function(attachment);
        $('#cost_success_type').val("edit");
        $('#submit_final_cost').text('Continue');
        $('#cost_modal').modal('show');
    });
    $(document).on('click', '#add_cost_button', function () {
        $('#add_cost_form')[0].reset();
         
        $('#cost_action_type').val("add");
        $('#mc_cost_status').val("not paid").change();
        $('#mc_material_type').val("material").change();
        $('#material_label_name').text("Material name");
        $('.quantity_column').removeClass('d-none');
        $('#m_id').val($('#add_cost_id').val());
        $('#add_cost_modal').modal('show');
    });
    $(document).on('click', '.edit_cost', function () {
        $('#add_cost_form')[0].reset();

        var id = $(this).attr("id");
        $.ajax({
            url: "{% url 'services:cost-rud' id=12345 %}".replace(/12345/, id).toString(),
            method: "GET",

            data: {
                id: id
            },
            dataType: "json",
            success: function (data) {
                 
                $('.cost_title').text(data.name);
                $('#costs_id').val(id);
                $('#cost_action_type').val('edit');
                $('#m_id').val(data.maintenance);
                $('#s_id').val(data.maintenance);
                $('#attm_id').val(data.maintenance);
                $('#mc_cost_paid_by').val(data.paid_by).change();
           
               
                $('#mc_material').val(data.cost_name);
                $('#mc_material_type').val(data.cost_type).change();
                $('#mc_cost').val(data.cost_total);
                $('#mc_cost_date').val(data.paid_date);
                $('#ref_no').val(data.ref_no);
                $('#mc_cost_status').val(data.paid).change();
                $('#paid_through').val(data.paid_through).change();
                $('#mc_material_qty').val(data.cost_number);
                $('#mc_desc').val(data.cost_description);

                $('#add_cost_modal').modal('show');

            }
        })
    });
    $(document).on('submit', '#add_cost_form', function (event) {
        var action_type = $('#cost_action_type').val()
        if (action_type == 'add') {
            var method = 'POST';
            var url = '{% url "services:cost-listcreate" %}';
        }
        if (action_type == 'edit') {
            var id = $('#costs_id').val();
            var method = 'PUT';
            var url = "{% url 'services:cost-rud' id=12345 %}".replace(/12345/, id).toString();
        }
        var form_data = new FormData(this);
        event.preventDefault();
        $.ajax({
            method: method,
            url: url,
            data: form_data,
            contentType: false,
            processData: false,
            dataType: "json",
            beforeSend: function () {
                $('#submit_cost').attr('disabled', 'disabled');
                $("#submit_cost").html("Please wait");
            },
            success: function (data) {
                $('#submit_cost').attr('disabled', false);
                $("#submit_cost").html("Upload records");
                if (data.success) {
                    cost_function(data.response.maintenance);
                    $('#add_cost_modal').modal('hide');
                    $('#success_text').text(data.success);
                    $('#success_alert').modal('show');
                    f_requests_table();
                }
                if (data.error) {
                    $('#oops_text').text(data.error);
                    $('#oops_alert').modal('show');
                }
            },
            error: function (jqXhr) {
                $('#submit_cost').attr('disabled', false);
                $("#submit_cost").html("Upload records");
                $('#oops_text').text("Something went wrong, try again later");
                $('#oops_alert').modal('show');

            }
        });
    });
 
    $(document).on('click', '.remove_cost', function () {
        var data = $(this).attr("id");
        var data_split = data.split(",");
        var id = data_split[0];
        var maintenance = data_split[1];
        $('#confirm_title').text("Are you sure?");
        $('#confirm_extra').text("Confirming the removal of this cost");
        $('#confirm_button').text("Confirm removal");
        $('#confirm_alert').modal('show');
        $('#confirmYes').off().on('click', function () {
            $.ajax({
                url: "{% url 'services:cost-rud' id=12345 %}".replace(/12345/, id)
                    .toString(),
                method: "DELETE",
                dataType: "json",
                data: {
                    id: id,
                },
                success: function (data) {
                    if (data.success) {
                        cost_function(maintenance);
                        $('#confirm_alert').modal('hide');
                        f_requests_table();
                    }
                    if (data.error) {
                        $('#oops_text').text(data.error);
                        $('#oops_alert').modal('show');
                        $('#confirm_alert').modal('hide');
                    }
                },
                error: function (jqXhr) {
                    $('#oops_text').text("Something went wrong, try again later");
                    $('#oops_alert').modal('show');
                    $('#confirm_alert').modal('hide');
                }

            });
        });
        $('#confirmNo').off().on('click', function () {
            $('#confirm_alert').modal('hide');
        });
    });

    function cost_function(maintenance) {
        url_data = '{% url "services:cost-listcreate" %}';
        $('#cost_table').DataTable({
            "destroy": true,
            "bAutoWidth": false,
            // "bLengthChange": false,
            "ordering": false,
            "oLanguage": {
                "sEmptyTable": "No labour/materials added",
                "sStripClasses": "",
                "sSearch": "",
                "sSearchPlaceholder": "search...",
                "sLengthMenu": '<span>Rows per page:</span><select class="browser-default">' +
                    '<option value="10">10</option>' +
                    '<option value="20">20</option>' +
                    '<option value="30">30</option>' +
                    '<option value="40">40</option>' +
                    '<option value="50">50</option>' +
                    '<option value="50">100</option>' +

                    '</select></div>'
            },
            initComplete: function () {
                var btns = $('.dt-button');
                btns.removeClass('dt-button');
            },
            "ajax": {
                "url": url_data,

                "data": {
                    "maintenance": maintenance,
                },
            },
            "searching": false,
            "bPaginate": false,
            "bInfo": false,
            "bProcessing": true,
            "scrollCollapse": true,
            "paging": false,

        });
        jQuery('#cost_table').wrap('<div class="dataTables_scroll" />');
        $('#cost_table').css('wdith', '100%');
        $('#cost_table').css('min-height', '200px');
        $('#add_cost_id').val(maintenance);
    }
    $(document).on('change', '#mc_material_type', function () {
        var request_type = $(this).val();
        if (request_type == "material") {
            $('#material_label_name').text("Material name");
            $('.quantity_column').removeClass('d-none');
            $('#mc_material').attr("placeholder", 'New sink');
        } else if (request_type == "labour") {
            $('#material_label_name').text("labourer's name");
            $('#mc_material').attr("placeholder", 'Dwayne johnson');
            $('.quantity_column').addClass('d-none');
            $('#mc_material_qty').val("");
        }
        $('.onboarding-modal .onboarding-slider-w').slick('setPosition');

    });
    //end costs---------------------------------------------------- 
</script>
{% endblock scripts %}



{% endblock content %}


<!--**********************************
    Content body end
***********************************-->